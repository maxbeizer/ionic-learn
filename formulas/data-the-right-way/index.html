<!DOCTYPE html>
<html lang='en'>
  <head>
    <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
    <meta charset='utf-8'>
    <title>Resolving Data the Right Way | Formulas | Learn Ionic</title>
    <link href='/css/site.css' rel='stylesheet'>
    <link href='//cdnjs.cloudflare.com/ajax/libs/animate.css/3.1.0/animate.min.css' rel='stylesheet'>
    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
      ga('create', 'UA-44023830-6', 'ionicframework.com');
      ga('send', 'pageview');
    </script>
  </head>
  <body class='full-page no-js'>
    <script>
      document.body.classList.remove('no-js');
    </script>
    <div class='container'>
      <div class='row'>
        <div class='side-nav'>
          <div class='logo'>
            <a href='/'>
              <img alt='Learn Ionic Framework' height='43' src='/img/learn-ionicframework@2x.png' width='194'>
            </a>
          </div>
          <nav>
            <ul>
              <li>
                <a href='/videos/'>
                  <i class='ion-videos'></i>
                  <p>Videos</p>
                </a>
              </li>
              <li>
                <a class='active' href='/formulas/'>
                  <i class='ion-formulas'></i>
                  <p>Formulas</p>
                </a>
              </li>
              <li>
                <a href='/talks/'>
                  <i class='ion-talks'></i>
                  <p>Talks</p>
                </a>
              </li>
              <li>
                <a href='/resources/'>
                  <i class='ion-resources'></i>
                  <p>Resources</p>
                </a>
              </li>
            </ul>
            <footer>
              <ul>
                <li>
                  <a href='https://github.com/driftyco/ionic-learn/issues/new' target='_new'>
                    <i class='ion-suggestions'></i>
                    <p>Suggest a Topic</p>
                  </a>
                </li>
                <li>
                  <a href='http://forum.ionicframework.com/' target='_new'>
                    <i class='ion-forum'></i>
                    <p>Forums</p>
                  </a>
                </li>
                <li>
                  <a href='https://github.com/driftyco/ionic' target='_new'>
                    <i class='ion-github'></i>
                    <p>Github</p>
                  </a>
                </li>
                <li>
                  <a href='https://twitter.com/ionicframework' target='_new'>
                    <i class='ion-twitter'></i>
                    <p>Twitter</p>
                  </a>
                </li>
                <li>
                  <a href='https://plus.google.com/+Ionicframework/posts' target='_new'>
                    <i class='ion-googleplus'></i>
                    <p>Plus</p>
                  </a>
                </li>
              </ul>
            </footer>
            <form action='http://codiqa.createsend.com/t/t/s/thodi/' class='email-digest' method='post'>
              <label for='cm-thodi-thodi'>
                <p>Sign up for the weekly Learn Digest!</p>
              </label>
              <div class='digest-wrapper'>
                <input name='cm-thodi-thodi' placeholder='Email address' required type='email'>
                <input type='submit' value='Go'>
              </div>
            </form>
            <div class='email-digest-success'>
              <p>Thanks for signing up. Every Friday you'll get an update on all of the new and exciting lessons on Learn Ionic!</p>
            </div>
          </nav>
        </div>
        <div class='main-pane'>
          <div class='content formula'>
            <nav>
              <a class='left' href='/formulas/'>
                <i class='ion-chevron-left'></i>
                <span style='margin-left:0px;'>All Formulas</span>
              </a>
            </nav>
            <article>
              <header>
                <h1>Resolving Data the Right Way</h1>
                <div class='byline'>
                  <img src='/img/authors/gerred-dillon.png'>
                  <span class='author'>
                    Written by
                    <a href='https://twitter.com/justicefries' target='_new'>Gerred Dillon</a>
                  </span>
                  <time></time>
                </div>
                <div class='social-buttons'>
                  <a href="https://twitter.com/share" class="twitter-share-button" data-via="ionicframework" data-related="ionicframework">Tweet</a>
                  <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>
                </div>
              </header>
              <h2 id="getting-data-into-a-controller">Getting Data Into a Controller</h2>
              
              <p>When fetching outside data, it can be very tempting to structure an application to resolve promises within a controller. Here’s an example:</p>
              
              <div><div class="CodeRay">
                <div class="code"><pre>&#x000A;app.controller(<span class="string"><span class="delimiter">'</span><span class="content">ItemCtrl</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(<span class="predefined">$http</span>) {&#x000A;  <span class="keyword">var</span> _this = <span class="local-variable">this</span>&#x000A;  <span class="local-variable">this</span>.items = []&#x000A;&#x000A;  <span class="predefined">$http</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">/resource.json</span><span class="delimiter">'</span></span>).then(<span class="keyword">function</span>(data) {&#x000A;      _this.items = data.items&#x000A;  })&#x000A;})</pre></div>
              </div>
              </div>
              
              <p>This works, but is a bit messy. There is no encapsulation of our data, and we may have to repeat getting this resource across multiple controllers, making it not very DRY.</p>
              
              <p>A first fix might be to abstract it up into a service, like so:</p>
              
              <div><div class="CodeRay">
                <div class="code"><pre>&#x000A;app.controller(<span class="string"><span class="delimiter">'</span><span class="content">ItemCtrl</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(ItemsService) {&#x000A;  <span class="local-variable">this</span>.items = []&#x000A;&#x000A;  ItemsService.getItems().then(<span class="keyword">function</span>(items) {&#x000A;    <span class="local-variable">this</span>.items = items&#x000A;  })&#x000A;})</pre></div>
              </div>
              </div>
              
              <p>Although this is more expressive and encapsulates our items into a service with all of the advantages therein, there are still problems with this approach. Code for resolving our promises must still be maintained within each controller, and API changes to the Items resource can have widespread effects on our code.</p>
              
              <p>Fortunately, Ionic’s navigation system, backed by <code>ui-router</code>, handles this with its resolve phase. By handling the resolution of our promise outside of the controller, we drastically clean up the controller code, and abstract our logic up into our routing layer.
              Here’s an example of this in action:</p>
              
              <div><div class="CodeRay">
                <div class="code"><pre><span class="keyword">var</span> app = angular.module(<span class="string"><span class="delimiter">'</span><span class="content">ionicApp</span><span class="delimiter">'</span></span>, [<span class="string"><span class="delimiter">'</span><span class="content">ionic</span><span class="delimiter">'</span></span>])&#x000A;&#x000A;app.config(<span class="keyword">function</span>(<span class="predefined">$stateProvider</span>, <span class="predefined">$urlRouterProvider</span>) {&#x000A;  <span class="predefined">$urlRouterProvider</span>.otherwise(<span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span>)&#x000A;&#x000A;  <span class="predefined">$stateProvider</span>.state(<span class="string"><span class="delimiter">'</span><span class="content">root</span><span class="delimiter">'</span></span>, {&#x000A;    <span class="key">url</span>: <span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span>,&#x000A;    <span class="key">template</span>: <span class="string"><span class="delimiter">'</span><span class="content">{{itemCtrl.item.name}}</span><span class="delimiter">'</span></span>,&#x000A;    <span class="key">controller</span>: <span class="string"><span class="delimiter">'</span><span class="content">ItemCtrl as itemCtrl</span><span class="delimiter">'</span></span>,&#x000A;    <span class="key">resolve</span>: {&#x000A;      <span class="function">item</span>: <span class="keyword">function</span>(ItemsService) {&#x000A;        <span class="keyword">return</span> ItemsService.getItem()&#x000A;      }&#x000A;    }&#x000A;  })&#x000A;})&#x000A;&#x000A;app.service(<span class="string"><span class="delimiter">'</span><span class="content">ItemsService</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(<span class="predefined">$q</span>) {&#x000A;  <span class="keyword">return</span> {&#x000A;    <span class="function">getItem</span>: <span class="keyword">function</span>() {&#x000A;      <span class="keyword">var</span> dfd = <span class="predefined">$q</span>.defer()&#x000A;&#x000A;      setTimeout(<span class="keyword">function</span>() {&#x000A;        dfd.resolve({&#x000A;          <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">Mittens Cat</span><span class="delimiter">'</span></span>&#x000A;        })&#x000A;      }, <span class="integer">2000</span>)&#x000A;&#x000A;      <span class="keyword">return</span> dfd.promise&#x000A;    }&#x000A;  }&#x000A;})&#x000A;&#x000A;app.controller(<span class="string"><span class="delimiter">'</span><span class="content">ItemCtrl</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(item) {&#x000A;  <span class="local-variable">this</span>.item = item&#x000A;})</pre></div>
              </div>
              </div>
              
              <p>Resolve understands promises when they are returned, avoiding any boilerplate code. Note that <code>resolve</code> consists of an object. The object’s key specifies what the name of the injected results will be, while the value is a function that returns a value or a promise.</p>
              
              <p>Because of this, our controller is reduced to a single line containing the resolved item. Check out the information below, and simplify fetching your data across your entire application.</p>
              <section class='scratchpad'>
                <p>Try this tutorial out below in the Scratchpad:</p>
                <div id='scratch'></div>
              </section>
              <footer>
                <h6>further reading</h6>
                <div class='similar-items list'>
                  <div class='item-row'>
                    <div class='similar-item'>
                      <a href='/formulas/sharing-data-between-views/'>Sharing Data Between Views</a>
                      <p>Sharing data between views is easy. Doing it correctly is less easy. This formula will show best practices for sharing data across your application.</p>
                    </div>
                  </div>
                </div>
              </footer>
            </article>
          </div>
        </div>
      </div>
      <footer class='main'>
        <span class='attribution'>&copy; 2014 Drifty Co.</span>
        <span class='expand-wrapper'>
          <span class='expand'></span>
        </span>
        <nav id='nav'>
          <a href='http://ionicframework.com' target='_blank'>Ionic</a>
          <a href='https://github.com/driftyco/ionic' target='_blank'>Github</a>
          <a href='mailto:hi@ionicframework.com' target='_blank'>Contact us</a>
          <a href='https://github.com/driftyco/ionic-learn/issues/new' target='_blank'>Suggestions</a>
          <a href='http://ionicons.com/' target='_blank'>Ionicons</a>
          <a href='http://ionicframework.com/jobs/' target='_blank'>Jobs</a>
          <a href='http://forum.ionicframework.com/' target='_blank'>Forum</a>
          <a href='http://ionicframework.com/blog/' target='_blank'>Blog</a>
          <a href='http://drifty.com' target='_blank'>Drifty Co</a>
        </nav>
      </footer>
    </div>
    <div class='get-ionic-wrapper viewed'>
      <a class='get-ionic' href='http://www.ionicframework.com' target='_new'>Get building with Ionic today!</a>
      <a class='close-cta ion-ios7-close-empty' href='#'></a>
    </div>
    <script src='//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.0/jquery.min.js'></script>
    <script src='//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.1.1/js/bootstrap.min.js'></script>
    <script src='//scratch.ionicsdk.com/static/js/embed.js'></script>
      <script>
        $(function() {
          var getTemplate = function(url) {
            return $.ajax({url: location.pathname + '/' + url, dataType: 'text'})
          }
        
          $.when(getTemplate('template.html'), getTemplate('style.css'), getTemplate('script.js')).then(function(html, css, js) {
            var scratch = new IonicScratch({
              el: document.getElementById('scratch'),
              width: '100%',
              height: '600px',
              html: html[0],
              css: css[0],
              js: js[0]
            });
          })
        })
      </script>
    <script src='/js/main.js'></script>
  </body>
</html>
